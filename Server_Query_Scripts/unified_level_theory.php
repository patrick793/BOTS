<?php  include('config.php');  include('connect.php');  $user = $_GET['user'];  $token = $_GET['token'];  if($token == "friends")  {  $puzzleQuery = "SELECT * FROM   (SELECT username as champ, PUZZLE_ID, min(score) as hiscore from Score GROUP BY PUZZLE_ID) as f   RIGHT OUTER JOIN   (SELECT * FROM 	(SELECT PUZZLE_ID as pid, min(score) as myhiscore from Score WHERE username = '$user' GROUP BY pid) as x 	RIGHT OUTER JOIN 	(SELECT PUZZLE_ID, puzzle, user as author, published FROM Levels WHERE published = 1) 	as y ON x.pid = y.PUZZLE_ID )    as g ON f.PUZZLE_ID = g.PUZZLE_ID WHERE author != '$user';";   }   else if($token == "my")   {	$puzzleQuery = "SELECT * FROM   (SELECT username as champ, PUZZLE_ID, min(score) as hiscore from Score GROUP BY PUZZLE_ID) as f   RIGHT OUTER JOIN   (SELECT * FROM 	(SELECT PUZZLE_ID as pid, min(score) as myhiscore from Score WHERE username = '$user' GROUP BY pid) as x 	RIGHT OUTER JOIN 	(SELECT PUZZLE_ID, puzzle, user as author, published FROM Levels ) 	as y ON x.pid = y.PUZZLE_ID )    as g ON f.PUZZLE_ID = g.PUZZLE_ID WHERE author = '$user' ORDER BY published DESC;";   }  $result = $db->query($puzzleQuery);  if($result)  {      $length = mysqli_num_rows($result);      for($i = 0; $i < $length; $i++)      {          $row = mysqli_fetch_assoc($result);          echo $row['author'].",";          echo $row['puzzle'].",";          echo $row['PUZZLE_ID'].",";		  echo $row['myhiscore'].",";		  echo $row['hiscore'].",";		  echo $row['champ'].",";		  echo $row['published'].";";      }           die;  }  else  {    echo "Error";  }?>